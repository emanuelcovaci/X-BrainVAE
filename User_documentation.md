# Synthetic EEG Data Generation for Bias Reduction in Motor Imagery Classification

## Overview
This project is focused on assisting individuals with motor disabilities by exploring the potential of EEG (Electroencephalography) technology. Specifically, it aims to demonstrate that an EEG headset can detect when a person imagines moving their right or left arm, without any actual physical movements.

## Problem Statement
The primary challenge addressed in this project is the generalization of motor imagery classification models across different individuals. Although a model trained on one individual can achieve high accuracy, applying it to another person often results in significant accuracy loss due to the uniqueness of each individual's brain waves. This project seeks to develop a more generalizable model using synthetic EEG data generated by a Variational Autoencoder (VAE).

## Notebooks

### 1. Building the Dataset from Raw Files (`build_raw_emotiv_dataset.ipynb`)
This notebook is responsible for processing raw EEG data to generate a dataset that can be used for training and evaluating motor imagery classification models.

Original dataset can be found [here](https://www.kaggle.com/code/gcdatkin/eeg-hand-movement-user-prediction) and a copy of the original raw dataset can be found [here]([/guides/content/editing-an-existing-page](https://github.com/emanuelcovaci/X-BrainNet/tree/main/dataset/emotiv/Dataset)).

**Steps:**
- Load raw EEG data files.
- Save the processed data into a format suitable for model training.

**Key Sections:**
- **Data Loading and Preprocessing:** Instructions and code for loading and cleaning the raw data.
- **Dataset Export:** Final step to save the processed dataset for further use.

### 2. Building the EEG Classifier (`X-BrainNet_LSTM.ipynb`)
This notebook guides users through building and training a model to classify motor imagery based on the dataset prepared in the previous step.

**Steps:**
- Load the processed EEG dataset.
- Define and configure an LSTM-based neural network model for classification.
- Train the model on the training dataset.
- Evaluate the model's performance on a validation dataset.

**Key Sections:**
- **Model Definition:** Detailed description and implementation of the LSTM network architecture.
- **Training Loop:** Code to train the model, including loss calculation and backpropagation.
- **Evaluation:** Methods for assessing the model's accuracy, precision, recall, and other metrics on the validation set.

### 3. Generating Synthetic Data (`X-BrainVAE.ipynb`)
This notebook demonstrates how to use a Variational Autoencoder (VAE) to create synthetic EEG data that can be used to improve model generalization and reduce bias.

**Steps:**
- Load the training dataset.
- Define and configure a Variational Autoencoder (VAE).
- Train the VAE to learn the distribution of the EEG data.
- Generate synthetic EEG data by sampling from the VAE's latent space.
- Augment the original dataset with the synthetic data to train a more robust classifier.

**Key Sections:**
- **VAE Architecture:** Definition and explanation of the VAE's encoder, decoder, and reparameterization trick.
- **Training the VAE:** Code to train the VAE, including the loss function that combines reconstruction loss and KL divergence.
- **Synthetic Data Generation:** Steps to generate synthetic data from the trained VAE and how to integrate this data into further model training.

## How to Run the Project
To replicate the study and explore the potential of EEG-based motor imagery classification, follow these steps:

1. **Build the Dataset:**
   - Open and run `build_raw_emotiv_dataset.ipynb`.
   - Ensure that raw EEG data files are available in the specified directory.
   - Follow the steps to preprocess the data and generate the dataset.

2. **Train the Classifier:**
   - Open and run `X-BrainNet_LSTM.ipynb`.
   - Load the dataset generated from the previous step.
   - Train the LSTM-based classifier and evaluate its performance.

3. **Generate Synthetic Data:**
   - Open and run `X-BrainVAE.ipynb`.
   - Train the VAE on the EEG dataset.
   - Generate synthetic EEG data and use it to augment the training process, aiming to improve generalization across different individuals.

## Benefits of the Approach
- **Bias Mitigation:** By generating diverse synthetic data, the VAE helps reduce biases arising from limited or homogeneous datasets.
- **Reduced Need for Retraining:** The model becomes more generalizable, reducing the necessity for retraining on new users.
- **Data Augmentation:** Synthetic data provides additional training examples, especially valuable when real data is scarce.

 
